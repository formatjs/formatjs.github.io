"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[6367,4059,4594,1446],{1446:(e,t,n)=>{n.r(t),n.d(t,{formatElapsedTime:()=>i,getDocumentIndexId:()=>a,getDocumentProperties:()=>r.JN,getInnerType:()=>m,getVectorSize:()=>p,isArrayType:()=>d,isGeoPointType:()=>f,isVectorType:()=>l,validateSchema:()=>s});var o=n(4918),r=n(7916);async function i(e){return{raw:Number(e),formatted:await(0,r.j7)(e)}}async function a(e){if(e.id){if("string"!=typeof e.id)throw(0,o.$)("DOCUMENT_ID_MUST_BE_STRING",typeof e.id);return e.id}return await(0,r.NF)()}async function s(e,t){for(const[n,r]of Object.entries(t)){const t=e[n];if(void 0!==t&&(("geopoint"!==r||"object"!=typeof t||"number"!=typeof t.lon||"number"!=typeof t.lat)&&("enum"!==r||"string"!=typeof t&&"number"!=typeof t)))if("enum[]"===r&&Array.isArray(t)){const e=t.length;for(let o=0;o<e;o++)if("string"!=typeof t[o]&&"number"!=typeof t[o])return n+"."+o}else if(l(r)){const e=p(r);if(!Array.isArray(t)||t.length!==e)throw(0,o.$)("INVALID_INPUT_VECTOR",n,e,t.length)}else if(d(r)){if(!Array.isArray(t))return n;const e=m(r),o=t.length;for(let r=0;r<o;r++)if(typeof t[r]!==e)return n+"."+r}else if("object"!=typeof r){if(typeof t!==r)return n}else{if(!t||"object"!=typeof t)return n;const e=await s(t,r);if(e)return n+"."+e}}}const c={string:!1,number:!1,boolean:!1,enum:!1,geopoint:!1,"string[]":!0,"number[]":!0,"boolean[]":!0,"enum[]":!0},u={"string[]":"string","number[]":"number","boolean[]":"boolean","enum[]":"enum"};function f(e){return"geopoint"===e}function l(e){return"string"==typeof e&&/^vector\[\d+\]$/.test(e)}function d(e){return"string"==typeof e&&c[e]}function m(e){return u[e]}function p(e){const t=Number(e.slice(7,-1));switch(!0){case isNaN(t):throw(0,o.$)("INVALID_VECTOR_VALUE",e);case t<=0:throw(0,o.$)("INVALID_VECTOR_SIZE",e);default:return t}}},6452:(e,t,n)=>{n.d(t,{v:()=>s,e:()=>c});const o=Symbol("orama.insertions"),r=Symbol("orama.removals");var i;const a=(null===(i=globalThis.process)||void 0===i?void 0:i.emitWarning)??function(e,t){console.warn(`[WARNING] [${t.code}] ${e}`)};function s(e){"number"!=typeof e[o]&&(queueMicrotask((()=>{e[o]=void 0})),e[o]=0),e[o]>1e3?(a("Orama's insert operation is synchronous. Please avoid inserting a large number of document in a single operation in order not to block the main thread or, in alternative, please use insertMultiple.",{code:"ORAMA0001"}),e[o]=-1):e[o]>=0&&e[o]++}function c(e){"number"!=typeof e[r]&&(queueMicrotask((()=>{e[r]=void 0})),e[r]=0),e[r]>1e3?(a("Orama's remove operation is synchronous. Please avoid removing a large number of document in a single operation in order not to block the main thread, in alternative, please use updateMultiple.",{code:"ORAMA0002"}),e[r]=-1):e[r]>=0&&e[r]++}},4059:(e,t,n)=>{n.r(t),n.d(t,{innerInsertMultiple:()=>l,insert:()=>s,insertMultiple:()=>f});var o=n(1446),r=n(8598),i=n(6452),a=n(4918);async function s(e,t,n,s){const f=await e.validateSchema(t,e.schema);if(f)throw(0,a.$)("SCHEMA_VALIDATION_FAILURE",f);return async function(e,t,n,s){const{index:f,docs:l}=e.data,d=await e.getDocumentIndexId(t);if("string"!=typeof d)throw(0,a.$)("DOCUMENT_ID_MUST_BE_STRING",typeof d);if(!await e.documentsStore.store(l,d,t))throw(0,a.$)("DOCUMENT_ALREADY_EXISTS",d);const m=await e.documentsStore.count(l);s||await(0,r.VK)(e.beforeInsert,e,d,t);const p=await e.index.getSearchableProperties(f),w=await e.index.getSearchablePropertiesWithTypes(f),y=await e.getDocumentProperties(t,p);for(const[r,i]of Object.entries(y)){if(void 0===i)continue;const e=typeof i,t=w[r];if((!(0,o.isGeoPointType)(t)||"object"!=typeof i||"number"!=typeof i.lon||"number"!=typeof i.lat)&&!((0,o.isVectorType)(t)&&Array.isArray(i)||(0,o.isArrayType)(t)&&Array.isArray(i)||c.has(t)&&u.has(e)||e===t))throw(0,a.$)("INVALID_DOCUMENT_PROPERTY",r,t,e)}for(const o of p){var b,g,v,h;const t=y[o];if(void 0===t)continue;const r=w[o];await(null===(g=(b=e.index).beforeInsert)||void 0===g?void 0:g.call(b,e.data.index,o,d,t,r,n,e.tokenizer,m)),await e.index.insert(e.index,e.data.index,o,d,t,r,n,e.tokenizer,m),await(null===(h=(v=e.index).afterInsert)||void 0===h?void 0:h.call(v,e.data.index,o,d,t,r,n,e.tokenizer,m))}const I=await e.sorter.getSortableProperties(e.data.sorting),A=await e.sorter.getSortablePropertiesWithTypes(e.data.sorting),S=await e.getDocumentProperties(t,I);for(const o of I){const t=S[o];if(void 0===t)continue;const r=A[o];await e.sorter.insert(e.data.sorting,o,d,t,r,n)}s||await(0,r.VK)(e.afterInsert,e,d,t);return(0,i.v)(e),d}(e,t,n,s)}const c=new Set(["enum","enum[]"]),u=new Set(["string","number"]);async function f(e,t,n,o,i,s){i||await(0,r.F_)(e.beforeInsertMultiple,e,t);const c=t.length,u=e.schema;for(let r=0;r<c;r++){const n=await e.validateSchema(t[r],u);if(n)throw(0,a.$)("SCHEMA_VALIDATION_FAILURE",n)}return l(e,t,n,o,i,s)}async function l(e,t,n,o,i,a){n||(n=1e3),a??=0;const c=[];return await new Promise(((r,u)=>{let f=0;setTimeout((async function l(){const d=t.slice(f*n,++f*n);if(!d.length)return r();for(const t of d)try{const n=await s(e,t,o,i);c.push(n)}catch(m){u(m)}setTimeout(l,a)}),a)})),i||await(0,r.F_)(e.afterInsertMultiple,e,t),c}},4594:(e,t,n)=>{n.r(t),n.d(t,{remove:()=>a,removeMultiple:()=>s});var o=n(8598),r=n(5533),i=n(6452);async function a(e,t,n,a){let s=!0;const{index:c,docs:u}=e.data,f=await e.documentsStore.get(u,t);if(!f)return!1;const l=(0,r.f8)(e.internalDocumentIDStore,(0,r.Kj)(e.internalDocumentIDStore,t)),d=await e.documentsStore.count(u);a||await(0,o.VK)(e.beforeRemove,e,l);const m=await e.index.getSearchableProperties(c),p=await e.index.getSearchablePropertiesWithTypes(c),w=await e.getDocumentProperties(f,m);for(const o of m){var y,b,g,v;const r=w[o];if(void 0===r)continue;const i=p[o];await(null===(b=(y=e.index).beforeRemove)||void 0===b?void 0:b.call(y,e.data.index,o,l,r,i,n,e.tokenizer,d)),await e.index.remove(e.index,e.data.index,o,t,r,i,n,e.tokenizer,d)||(s=!1),await(null===(v=(g=e.index).afterRemove)||void 0===v?void 0:v.call(g,e.data.index,o,l,r,i,n,e.tokenizer,d))}const h=await e.sorter.getSortableProperties(e.data.sorting),I=await e.getDocumentProperties(f,h);for(const o of h)void 0!==I[o]&&await e.sorter.remove(e.data.sorting,o,t);return a||await(0,o.VK)(e.afterRemove,e,l),await e.documentsStore.remove(e.data.docs,t),(0,i.e)(e),s}async function s(e,t,n,i,s){let c=0;n||(n=1e3);const u=s?[]:t.map((t=>(0,r.f8)(e.internalDocumentIDStore,(0,r.Kj)(e.internalDocumentIDStore,t))));return s||await(0,o.F_)(e.beforeRemoveMultiple,e,u),await new Promise(((o,r)=>{let u=0;setTimeout((async function f(){const l=t.slice(u*n,++u*n);if(!l.length)return o();for(const t of l)try{await a(e,t,i,s)&&c++}catch(d){r(d)}setTimeout(f,0)}),0)})),s||await(0,o.F_)(e.afterRemoveMultiple,e,u),c}},6367:(e,t,n)=>{n.r(t),n.d(t,{update:()=>s,updateMultiple:()=>c});var o=n(8598),r=n(4918),i=n(4059),a=n(4594);async function s(e,t,n,r,s){!s&&e.beforeUpdate&&await(0,o.VK)(e.beforeUpdate,e,t),await(0,a.remove)(e,t,r,s);const c=await(0,i.insert)(e,n,r,s);return!s&&e.afterUpdate&&await(0,o.VK)(e.afterUpdate,e,c),c}async function c(e,t,n,s,c,u){u||await(0,o.F_)(e.beforeUpdateMultiple,e,t);const f=n.length;for(let o=0;o<f;o++){const t=await e.validateSchema(n[o],e.schema);if(t)throw(0,r.$)("SCHEMA_VALIDATION_FAILURE",t)}await(0,a.removeMultiple)(e,t,s,c,u);const l=await(0,i.innerInsertMultiple)(e,n,s,c,u);return u||await(0,o.F_)(e.afterUpdateMultiple,e,l),l}}}]);